var backUrl=window.sessionStorage.getItem("login.backUrl");if(backUrl!==null&&backUrl!==""){window.sessionStorage.removeItem("login.backUrl");if(backUrl!==document.URL){window.location.href=backUrl}}$(function(){loadAccessData();var a=$("#user_info_id");if(a.length===0){return}var b=a.attr("email");if(typeof b!=="undefined"){return}var e=window.sessionStorage.getItem("login.setEmailClose");if(e!==null&&e!==""){return}var d=a.attr("createTime");var c=a.attr("lastLoginTime");if(d===c){userEmailDialog(true)}});function thirdLogin(a){$.ajaxRequest({url:"/third-login/"+a+".html",data:{friend:"chendd"},type:"get",useWait:false,success:function(b){window.sessionStorage.setItem("login.backUrl",document.URL);window.location.href=b.data}})}function userInfoDialog(){$.openWindow("<b class='p-0 m-0 font-16'><i class=\"fe-user\"></i>&nbsp;用户信息</b>","/user/userInfo.html",{height:"260px",buttons:{cancel:{label:'<i class="fe-x"></i>&nbsp;取消',className:"btn-primary"}}})}function userEmailDialog(a){var c="设置Email";var b={cancel:{label:'<i class="fe-x"></i>&nbsp;取消',className:"btn-primary"}};if(a){c=c+"（首次登录）";b.ok={label:'<i class="fe-x"></i>&nbsp;不再提示',className:"btn-danger",callback:function(){window.sessionStorage.setItem("login.setEmailClose","true");return true}}}$.openWindow("<b class='p-0 m-0 font-16'><i class=\"fe-mail\"></i>&nbsp;"+c+"</b>","/user/userEmail.html",{height:"260px",buttons:b})}function loadAccessData(){if($("#access_today_id").length===0){return}$.ajaxRequest({url:"/blog/access.html",type:"get",useWait:false,success:function(a){var b=a.data;$("#access_yesterday_id").text(b.yesterday);$("#access_today_id").text(b.today);$("#access_todayOutLink_id").text(b.todayOutLink);$("#access_maxCount_id").text(b.maxCount);$("#access_maxDay_id").text(b.maxDay);$("#access_total_id").text(b.total);$("#label_today_id").text(b.today);$("#label_todayOutLink_id").text(b.todayOutLink);$("#label_yesterday_id").text(b.yesterday);$("#label_maxCount_id").text(b.maxCount);$("#label_maxDay_id").text("最高："+b.maxDay);$("#label_total_id").text(b.total)},error:function(b){}})}(function(c){var d=window;while(d!==window.top){if(d.parent.bootbox!==undefined){d=window.parent}else{break}}c.win=function(){return d};var b=function(f,g){var e=['<div class="media"><div class="media-left">','<img class="media-object img-lg img-circle" src="/statics/plugins/bootbox/icons/'+f+'.png">',"</div>",'<div class="media-body">'+g+"</div></div>"];return e.join("")};c.alert=function(g,f,h,e){d.bootbox.alert({title:h||"提示",className:"dialog-alert",centerVertical:true,backdrop:"static",scrollable:true,message:b(e||"warn",g),locale:"zh_CN",callback:f||function(){},buttons:{ok:{label:"确定",className:"btn-primary"}}})};c.alert.success=function(f,e){c.alert(f,e,"提示","success")};c.alert.warn=function(f,e){c.alert(f,e,"警告","warn")};c.alert.error=function(f,e){c.alert(f,e,"错误","error")};c.confirm=function(f,e,g){d.bootbox.confirm({title:g||"询问",className:"dialog-confirm",centerVertical:true,backdrop:"static",message:b("question",f),callback:e,locale:"zh_CN",buttons:{cancel:{label:"取消",className:"btn-soft-secondary waves-effect"},confirm:{label:"确定",className:"btn-danger"}}})};c.loading=function(e){if(d.loading){return d.loading}d.loading=d.bootbox.dialog({message:"<div align='center'><i class='fa fa-spin fa-spinner'></i>&nbsp;&nbsp;"+e+"</div>",closeButton:false,animate:false,centerVertical:true,size:"small"});return d.loading};c.loading.show=function(e){if(!d.loading){c.loading(e)}};c.loading.hide=function(){window.setTimeout(function(){if(d.loading){d.loading.modal("hide");d.loading=undefined}},0)};c.openWindow=function(g,f,e){d.openWindow=d.bootbox.dialog({title:g==="none"?null:g+"<label id='dialog_page_title_"+f+"'></label>",className:e.className||"dialog-page",centerVertical:false,closeButton:e.closeButton===undefined?true:e.closeButton,size:e.size||"large",backdrop:e.backdrop===undefined?true:e.backdrop,scrollable:true,message:a(f,e&&e.height),locale:"zh_CN",buttons:e.buttons||{cancel:{label:'<i class="fe-x"></i>&nbsp;取消',className:"btn-default",callback:(e&&e.calcelCallback)||function(){}},confirm:{label:'<i class="fe-save"></i>&nbsp;确定',className:"btn-blue",callback:(e&&e.submitCallback)||function(){var h="iframe_"+f;d.document.getElementById(h).contentWindow.submitForm();return false}}}});if(e&&e.callback!==undefined){e.callback.apply(this,[])}};c.closeWindow=function(e){if(e){d.$("label[id^='dialog_page_title_"+e+"']").parents(".bootbox.modal").modal("hide");return}d.openWindow.modal("hide");d.openWindow=null};c.template=function(h,e){var g=c("#"+h).html().replace("<![CDATA[","").replace("]]>","");var f=template.render(g,e);return f};function a(f,e){var g=["<h5 ","id='loading_",f,"'","class='nav flex-column justify-content-center text-center' style='overflow:hidden;height:",e,";'><p><i class='spinner-grow text-primary m-2'></i><i class='spinner-grow text-primary m-2'></i><i class='spinner-grow text-primary m-2'></i></p>","</h5>","<iframe id='iframe_",f,"' src='",f,"' onload=\"","document.getElementById('loading_",f,"').style.display='none';this.style.display='block';\"","' style='display:none;width:100%;height:",(e||"460px"),"';"," frameborder='0' scrolling='no' ","></iframe>"];return g.join("")}})(jQuery);(function(a){function b(c){var d={url:null,dataType:"json",contentType:"application/x-www-form-urlencoded",type:"post",async:true,useWait:true,timeout:20000*3,callback:c.callback||function(){},onBeforeSend:function(e){if(d.useWait===true){a.loading.show("操作正在执行中...")}if(c.beforeSend){c.beforeSend(e)}},onSuccess:function(e){if(d.useWait===true){a.loading.hide()}if(this.dataType==="json"&&e.result!=="success"){a.alert.error(e.message,c.callback)}else{if(c.success){c.success(e)}}},onError:function(f,e,g){if(d.useWait===true){a.loading.hide()}if(c.error){c.error(f,e,g)}else{a.alert("操作出现错误，参考信息："+f.statusText)}}};return d}jQuery.extend({ajaxRequest:function(c){var d=b(c);var c=a.extend(d,c);if(["PUT","DELETE"].indexOf(c.type.toUpperCase())!==-1){c.contentType="application/json"}c.beforeSend=d.onBeforeSend;c.success=d.onSuccess;c.error=d.onError;a.ajax(c)},formToValues:function(k,c,h,j){var g=a("#"+k).formToArray(c,h,j);var d={};for(var e=0;e<g.length;e++){var f=g[e];if(d.hasOwnProperty(f.name)){d[f.name]=d[f.name]+","+f.value}else{d[f.name]=f.value}}return d},clearForm:function(d,c){a("#"+d).clearForm(c)},setUserInfo:function(c){var d=JSON.stringify(c);window.sessionStorage.setItem("userContext",d)},getUserInfo:function(e){var d=window.sessionStorage.getItem("userContext");if(!d){if(e){return null}return{}}var c=JSON.parse(d);if(!e){return c}return c[e]},clearUserInfo:function(){window.sessionStorage.removeItem("userContext")},getUserSetting:function(d){var c=window.localStorage.getItem("userSetting");if(!c){if(d){return null}return{}}var e=JSON.parse(c);if(!d){return e}return e[d]},setUserSetting:function(d,f){var c=window.localStorage.getItem("userSetting");var e;if(!c){e={}}else{e=JSON.parse(c)}e[d]=f;window.localStorage.setItem("userSetting",JSON.stringify(e))},clearUserSetting:function(d){var c=window.localStorage.getItem("userSetting");if(!c){return}var e=JSON.parse(c);if(d){delete e[d];window.localStorage.setItem("userSetting",JSON.stringify(e))}else{window.localStorage.removeItem("userSetting")}}})})(jQuery);(function(c){c.fn.datagrid=function(f,i){var h=c(this);if(typeof f==="string"&&typeof i!=="undefined"){return this.bootstrapTable(f,i)}else{if(typeof f==="string"&&typeof i==="undefined"){return this.bootstrapTable(f)}}var g={theadClasses:"thead-light",clickToSelect:true,method:"post",icons:{refresh:"fa-refresh",fullscreen:"fa-arrows-alt",toggleOn:"fa-toggle-on",toggleOff:"fa-toggle-off",columns:"fa-th-list"},showColumns:true,showRefresh:true,showToggle:false,pagination:false,toolbarAlign:"left",queryParamsType:"",sidePagination:"server",pageNumber:1,pageSize:10,pageList:[10,25,50],totalField:"total",dataField:"records",ajaxOptions:{beforeSend:function(j){a(h);return true}},contentType:"application/x-www-form-urlencoded",queryParams:function(k){var j=c.formToValues("query_form_id");var l=c.extend(j,k);return l},responseHandler:function(j){e(h);if(j.result==="success"){return j.data}h.datagrid("hideLoading");c.alert(j.message)},onPostHeader:function(){if(!f.rightButton){return}var k=f.rightButton.length;if(k==0){return}var j=f.rightButton[0];if(c("#"+j.id).length>0){return}var o="";for(var m=0;m<k;m++){var n=f.rightButton[m];var l=d(n);o+=l}h.parents(".bootstrap-table").find(".fixed-table-toolbar .columns").prepend(o);for(var m=0;m<k;m++){var n=f.rightButton[m];c("#"+n.id).click(n.click)}}};var f=c.extend(g,f);return h.bootstrapTable(b(f))};function b(g){var j=g.columns;if(typeof j==="array"&&j.length>0){j=j[j.length-1]}for(var h=0;h<j.length;h++){var k=j[h];var f=k.hasOwnProperty("rownum");if(f&&k.rownum===true&&!k.hasOwnProperty("formatter")){k.formatter=function(l,i,m){return m+1};break}}return g}function a(g){var f=window.top.$(".content-tabs[currentTheme]");if(f.length===1){if(f.attr("currentTheme")==="dark"){c(".fixed-table-loading").css("background","#303841")}else{c(".fixed-table-loading").css("background","#fff")}}}function e(f){}function d(g){var f=["<button class='",g.className,"' type='button' id='",g.id,"' title='",g.title,"'>","<i class='",g.icon,"'></i>","</button>"];return f.join("")}})(jQuery);(function(a){a.helper={notNull:function(c){var b=[undefined,"undefined",null,"null"];return b.indexOf(c)!==-1?"":c},getDate:function(){var c=new Date();var d=c.getFullYear();var e=c.getMonth()+1,e=e<10?"0"+e:e;var b=c.getDate(),b=b<10?"0"+b:b;return d+"-"+e+"-"+b},getParameters:function(e){var j=window.location.search;var g={};if(j.length==0){return g}var c=j.substr(1).split("&");for(var b=0;b<c.length;b++){var h=c[b].split("=");var d=h[0];var f=decodeURI(decodeURI(h[1]));if(g[d]){g[d]=g[d]+(e||",")+f}else{g[d]=f}return g}},getParameter:function(b,d){var c=a.helper.getParameters(d)[b];return a.helper.notNull(c)}}})(jQuery);$(function(){$(".resetForm").each(function(){var a=$(this);a.click(function(){var b=a.parents("form").attr("id");$.clearForm(b,true);$('[data-date-default="true"]').each(function(){$(this).val($.helper.getDate())})})});$(".enterSubmit").each(function(){var a=$(this);a.keyup(function(c){var b=a.val();if(c.keyCode===13&&b!==""){$("#query_btn_id").click()}})});$(".not-chinese").each(function(){var a=$(this);a.on({paste:function(){return false},dragenter:function(b){return false},keyup:function(){a.val(a.val().replace(/[\u0391-\uFFE5]/gi,""))},dragover:function(){return false}})});$('[data-date-default="true"]').each(function(){$(this).val($.helper.getDate())});$("#returnTop_id").click(function(){$("html, body").animate({scrollTop:0},300)});$("#returnBottom_id").click(function(){var a=$(document).height();$("html, body").animate({scrollTop:a},300)})});